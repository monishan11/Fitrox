<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workout</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background: linear-gradient(to bottom, #1e3c72, #2a5298); /* Gradient background */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh; /* Full viewport height */
        }

        canvas { 
            display: block; 
        }

        #moveButton {
            position: absolute;
            bottom: 10px;
            right: 10px;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        #moveButton:hover {
            background-color: #0056b3; /* Darker blue on hover */
        }

        /* Styling for the "You are here" message */
        #youAreHereMessage {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            display: none;
        }
    </style>
</head>
<body>
    <button id="moveButton">Move</button>
    <div id="youAreHereMessage">You are here</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, track, avatar;
        let segmentCount = 100; // Smoothness of the track
        let avatarProgress = 0; // Start at the beginning
        const totalSegments = 30;

        function init() {
            // Set up scene
            scene = new THREE.Scene();

            // Set up camera
            const aspect = window.innerWidth / window.innerHeight;
            const frustumSize = 20;
            camera = new THREE.OrthographicCamera(
                -frustumSize * aspect / 2, frustumSize * aspect / 2,
                frustumSize / 2, -frustumSize / 2,
                0.1, 1000
            );
            camera.position.z = 10;

            // Set up renderer
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x90EE90); // Light green background color
            document.body.appendChild(renderer.domElement);

            // Create the track as a flat line
            const path = new THREE.CatmullRomCurve3([
                new THREE.Vector3(-15, 0, 0),
                new THREE.Vector3(-10, 5, 0),
                new THREE.Vector3(-5, 0, 0),
                new THREE.Vector3(0, 5, 0),
                new THREE.Vector3(5, 0, 0),
                new THREE.Vector3(10, -5, 0),
                new THREE.Vector3(15, 0, 0)
            ]);

            const trackGeometry = new THREE.BufferGeometry().setFromPoints(path.getPoints(segmentCount));
            const trackMaterial = new THREE.LineBasicMaterial({ color: 0x999999 });
            track = new THREE.Line(trackGeometry, trackMaterial);
            scene.add(track);

            // Create the avatar as a 2D circle
            const avatarGeometry = new THREE.CircleGeometry(0.5, 32);
            const avatarMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
            avatar = new THREE.Mesh(avatarGeometry, avatarMaterial);
            avatar.position.set(-15, 0, 0);
            scene.add(avatar);

            // Button to move the avatar
            document.getElementById('moveButton').addEventListener('click', moveAvatar);

            animate();
        }

        function moveAvatar() {
            if (avatarProgress < 1) {
                avatarProgress += 1 / totalSegments;
                updateAvatarPosition();
            }
        }

        function updateAvatarPosition() {
            const path = new THREE.CatmullRomCurve3([
                new THREE.Vector3(-15, 0, 0),
                new THREE.Vector3(-10, 5, 0),
                new THREE.Vector3(-5, 0, 0),
                new THREE.Vector3(0, 5, 0),
                new THREE.Vector3(5, 0, 0),
                new THREE.Vector3(10, -5, 0),
                new THREE.Vector3(15, 0, 0)
            ]);

            const pointOnPath = path.getPointAt(avatarProgress);
            avatar.position.set(pointOnPath.x, pointOnPath.y, 0);

            // Show the "You are here" message near the avatar
            showMessage(pointOnPath.x, pointOnPath.y);
        }

        function showMessage(x, y) {
            const messageElement = document.getElementById('youAreHereMessage');

            // Convert the 3D world coordinates to 2D screen coordinates
            const vector = new THREE.Vector3(x, y, 0);
            vector.project(camera); // Project 3D coordinates to 2D

            // Normalize coordinates to be between -1 and 1
            const widthHalf = window.innerWidth / 2;
            const heightHalf = window.innerHeight / 2;
            const screenX = (vector.x * widthHalf) + widthHalf;
            const screenY = -(vector.y * heightHalf) + heightHalf;

            // Position the "You are here" message
            messageElement.style.left = `${screenX - messageElement.offsetWidth / 2}px`; // Center the message
            messageElement.style.top = `${screenY - messageElement.offsetHeight / 2}px`; // Center the message
            messageElement.style.display = 'block'; // Show the message

            // Hide the message after 3 seconds
            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 3000); // 3000 milliseconds = 3 seconds
        }

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>
